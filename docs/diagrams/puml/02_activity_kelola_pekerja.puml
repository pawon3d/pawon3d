@startuml Activity Diagram - Proses Mengelola Pekerja

|Pemilik|
start
:Membuka halaman Pekerja;

if (Aksi?) then (Tambah)
    :Klik tombol Tambah Pekerja;
    :Mengisi form pekerja;
    note right
      Data pekerja:
      - Nama
      - Email (unik)
      - Nomor telepon
      - Jenis kelamin
      - Foto (opsional)
      (tanpa password)
    end note
    
    :Memilih peran (role);
    note right
      Peran tersedia:
      - Kasir
      - Produksi
      - Inventori
      - (atau custom role)
    end note
    
    :Menyimpan pekerja;
    
    |Sistem|
    :Validasi data;
    
    if (Email sudah terdaftar?) then (Ya)
        :Menampilkan pesan error;
    else (Tidak)
        :Menyimpan ke database (is_active=false);
        :Generate invitation token;
        :Assign role ke user;
        :Kirim email undangan aktivasi;
        :Menampilkan pesan sukses;
    endif

else if (Aksi?) then (Kirim Ulang Undangan)
    |Pemilik|
    :Memilih pekerja yang belum aktivasi;
    :Klik Kirim Ulang Undangan;
    
    |Sistem|
    :Generate invitation token baru;
    :Kirim email undangan aktivasi;
    :Menampilkan pesan sukses;
    
else if (Aksi?) then (Toggle Aktif/Nonaktif)
    |Pemilik|
    :Memilih pekerja;
    :Klik toggle aktif/nonaktif;
    
    |Sistem|
    if (Status saat ini?) then (Aktif)
        :Set is_active = false;
        :Pekerja tidak bisa login;
    else (Nonaktif)
        :Set is_active = true;
        :Pekerja bisa login kembali;
    endif
    :Menampilkan pesan sukses;
    
else if (Aksi?) then (Edit)
    |Pemilik|
    :Memilih pekerja yang akan diedit;
    :Mengubah data pekerja;
    :Mengubah peran (opsional);
    :Menyimpan perubahan;
    
    |Sistem|
    :Validasi data;
    :Update data pekerja;
    
    if (Role berubah?) then (Ya)
        :Sync role baru;
        :Hapus role lama;
    else (Tidak)
    endif
    
    :Menampilkan pesan sukses;
    
else if (Aksi?) then (Lihat Detail)
    |Pemilik|
    :Memilih pekerja;
    
    |Sistem|
    :Menampilkan detail pekerja;
    :Menampilkan status (Aktif/Nonaktif/Menunggu);
    :Menampilkan role & permission;
    :Menampilkan riwayat aktivitas;
    note right
      Aktivitas:
      - Transaksi yang dibuat
      - Produksi yang dikerjakan
      - Login terakhir
    end note
    
else (Hapus)
    |Pemilik|
    :Memilih pekerja yang akan dihapus;
    :Konfirmasi penghapusan;
    
    |Sistem|
    if (Pekerja punya transaksi/produksi?) then (Ya)
        :Menampilkan peringatan;
        :Nonaktifkan pekerja saja;
    else (Tidak)
        :Hapus pekerja permanen;
    endif
    :Menampilkan pesan sukses;
endif

stop

@enduml
