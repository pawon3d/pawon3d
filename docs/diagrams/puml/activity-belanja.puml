@startuml activity-belanja

title Activity Diagram: Proses Belanja Bahan Baku

start

:Pengguna mengakses halaman belanja;

partition "Perencanaan Belanja" {
    :Buat rencana belanja baru;
    :Pilih supplier;
    :Generate nomor belanja (BP-YYMMDD-XXXX);
    
    repeat
        :Pilih bahan baku;
        :Masukkan kuantitas rencana;
        :Pilih satuan;
    repeat while (Tambah item lagi?) is (Ya)
    -> Tidak;
    
    :Simpan rencana belanja;
    :Status = Rencana;
}

partition "Pelaksanaan Belanja" {
    :Pilih rencana belanja;
    :Mulai proses belanja;
    
    repeat
        :Pilih item bahan;
        :Masukkan kuantitas aktual;
        :Masukkan harga satuan;
        :Masukkan tanggal kedaluwarsa;
        :Hitung subtotal otomatis;
    repeat while (Item berikutnya?) is (Ya)
    -> Tidak;
    
    :Hitung total belanja;
    
    if (Konfirmasi selesai?) then (Ya)
        :Simpan detail belanja;
        
        fork
            :Buat batch baru per item;
        fork again
            :Update status bahan (recalculateStatus);
        fork again
            :Catat log inventori;
        end fork
        
        :Status = Selesai;
        :Tampilkan notifikasi sukses;
    else (Tidak)
        :Simpan sebagai draft;
    endif
}

partition "Pencetakan (Opsional)" {
    if (Cetak detail belanja?) then (Ya)
        :Generate PDF detail belanja;
        :Download file PDF;
    else (Tidak)
    endif
}

stop

@enduml
