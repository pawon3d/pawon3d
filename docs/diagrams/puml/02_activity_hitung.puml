@startuml Activity Diagram - Proses Hitung Stok

|Inventori|
start
:Membuka halaman Hitung;
:Membuat rencana hitung baru;

:Memilih jenis aksi;
note right
  Jenis aksi:
  - Hitung (stock opname)
  - Rusak (catat rusak)
  - Hilang (catat hilang)
end note

if (Jenis aksi?) then (Hitung)
    :Memilih bahan yang akan dihitung;
    :Menyimpan rencana hitung;
    
    |Sistem|
    :Generate nomor hitung (HC-YYMMDD-XXXX);
    :Menyimpan hitung dengan status: Rencana;
    :Menyimpan hitung details;
    
    |Inventori|
    :Memulai penghitungan;
    
    |Sistem|
    :Update status: Proses;
    
    |Inventori|
    :Memasukkan jumlah aktual hasil hitung;
    
    |Sistem|
    :Menghitung selisih (sistem vs aktual);
    
    if (Ada selisih?) then (Ya)
        :Mencatat adjustment;
        :Update stok bahan baku;
        :Mencatat log inventori (adjustment);
    else (Tidak)
        :Tidak ada perubahan stok;
    endif
    
elseif (Jenis aksi?) then (Rusak)
    :Memilih bahan yang rusak;
    :Memasukkan jumlah rusak;
    :Menyimpan rencana;
    
    |Sistem|
    :Generate nomor hitung;
    :Menyimpan dengan status: Rencana;
    
    |Inventori|
    :Memulai proses catat rusak;
    :Mengkonfirmasi jumlah rusak;
    
    |Sistem|
    :Mengurangi stok bahan baku;
    :Mencatat log inventori (rusak);
    
else (Hilang)
    :Memilih bahan yang hilang;
    :Memasukkan jumlah hilang;
    :Menyimpan rencana;
    
    |Sistem|
    :Generate nomor hitung;
    :Menyimpan dengan status: Rencana;
    
    |Inventori|
    :Memulai proses catat hilang;
    :Mengkonfirmasi jumlah hilang;
    
    |Sistem|
    :Mengurangi stok bahan baku;
    :Mencatat log inventori (hilang);
endif

|Sistem|
:Update status hitung: Selesai;
:Recalculate status bahan otomatis;
note right
  Status bahan berubah berdasarkan:
  - Expired: ada batch expired
  - Kosong: stok = 0
  - Habis: stok <= minimum
  - Hampir Habis: stok rendah
  - Tersedia: stok cukup
end note
:Kirim notifikasi (Hitung selesai);

stop

@enduml
